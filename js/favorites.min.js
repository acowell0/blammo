var getFaves=function(b){b="https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=20&playlistId=%%%playlist%%%&fields=items(id%2Csnippet%2Ftitle%2Csnippet%2Fdescription%2Csnippet%2FresourceId%2FvideoId%2Csnippet%2Fthumbnails%2Fdefault%2Furl)&access_token=".replace("%%%playlist%%%",b);b+=auth.token.access_token;populateResults(b,$("#faveResults"),"f")},isFave=function(b){for(i=0;i<init.faves.length;i++)if(init.faves[i].vidId==b)return 1;return-1},addFave=function(b,a){-1===isFave(b)&&
(init.faves.push({vidId:b,playlistitemid:"x"}),$.ajax({type:"POST",url:"https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&fields=snippet%2C+id&access_token="+auth.token.access_token,contentType:"application/json; charset=utf-8",data:'{"snippet": {"playlistId": "'+a+'", "resourceId": { "kind": "youtube#video","videoId": "'+b+'" } } }',dataType:"json",success:function(a){console.log("insertion successful");updateFavesArray(a,b);addFaveToDOM(a,$("#faveResults"),b)},error:function(a){console.log(a);
alert("An error occurred trying to insert playlist item: ["+b+"]. See log for details.")}}))},updateFavesArray=function(b,a){for(i=0;i<init.faves.length;i++)init.faves[i].vidId==a&&(init.faves[i].playlistitemid=b.id)},addFaveToDOM=function(b,a,c){if(0==$(a).find("ul").length){var d=$('<ul id="f" class="media-list"></ul>');$(a).append(d)}a='<li class="media f" data-video="'+c+'"><a class="media-left" href="#">';a+='<img class="media-object" src="'+b.snippet.thumbnails["default"].url+'" >';a+="</a>";
a+='<div class="media-body">';a+='<h4 class="media-heading">'+b.snippet.title+"</h4>";a+="<p>"+b.snippet.description+"</p>";a+="</div>";a+="</li>";b=$(a).click(function(){var a='<label><input type="checkbox" checked> Fave</label>',b="https://www.googleapis.com/youtube/v3/videos?part=snippet%2C+statistics&id="+$(this).attr("data-video")+"&maxResults=1&fields=items(snippet%2FchannelTitle%2Cstatistics)&key=AIzaSyAgNqfgP847pRTGlFzhirgATebC768fxbY",c="https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&videoId="+
$(this).attr("data-video")+"&fields=items(snippet%2FtopLevelComment%2Fsnippet%2FauthorDisplayName%2Csnippet%2FtopLevelComment%2Fsnippet%2FtextDisplay)&key=AIzaSyAgNqfgP847pRTGlFzhirgATebC768fxbY",d='<iframe data-video="'+$(this).attr("data-video")+'" width="640" height="360" src="http://www.youtube.com/embed/'+$(this).attr("data-video")+'" frameborder="0" allowfullscreen></iframe>';removeVideoFrame();$.getJSON(b,function(a){$("#videoModal").find("#channel").text("CHANNEL: "+a.items[0].snippet.channelTitle);
$("#videoModal").find("#views").text("VIEWS: "+Number(a.items[0].statistics.viewCount).toLocaleString("en"));$("#videoModal").find("#likes").text("LIKES: "+Number(a.items[0].statistics.likeCount).toLocaleString("en"));$("#videoModal").find("#dislikes").text("DISLIKES: "+Number(a.items[0].statistics.dislikeCount).toLocaleString("en"))});$.getJSON(c,function(a){for(j=0;j<a.items.length;j++){var b="<li><b>"+a.items[j].snippet.topLevelComment.snippet.authorDisplayName+' says: </b>"'+a.items[j].snippet.topLevelComment.snippet.textDisplay+
'" </li>';$("#videoModal").find("#comments").append(b)}});$("#videoModal").find("#video").append(d);$(".modal-title").text($(this).find(".media-heading").text());init.authenticated&&(-1===isFave($(this).attr("data-video"))&&(a=a.replace("checked","")),$("#videoModal").find("#fave").append(a));$("#videoModal").modal("show")});$("#f").append(b)},removeFave=function(b){console.log("removing fave: "+b);var a;for(i=0;i<init.faves.length;i++)if(init.faves[i].vidId==b){a=init.faves[i].playlistitemid;init.faves.splice(i,
1);break}if(void 0!=a){var c="https://www.googleapis.com/youtube/v3/playlistItems?id=%%%id%%%&access_token="+auth.token.access_token,c=c.replace("%%%id%%%",a);$.ajax({type:"DELETE",url:c,dataType:"json",success:function(){console.log("deletion successful");$("#faveResults").find("li[data-video="+b+"]").remove();removeVideoFrame()},error:function(b){console.log(b);alert("An error occurred trying to delete playlist item ["+a+"]. See log for details.")}})}},createPlaylist=function(b){var a="https://www.googleapis.com/youtube/v3/playlists?part=snippet%2C+status&fields=id&access_token="+
auth.token.access_token;b='{ "snippet": { "title": "'+b+'", "description": "A private playlist created with the YouTube API used by the blammo JavaScript demo" }, ';b+='"status": { "privacyStatus": "private" } }';$.ajax({type:"POST",url:a,contentType:"application/json; charset=utf-8",data:b,dataType:"json",success:function(a){console.log("playlist successfully created: "+a.id);init.favePlaylistId=a.id},error:function(a){console.log(a);alert("An error occurred trying to create playlist. See log for details.")}})};
